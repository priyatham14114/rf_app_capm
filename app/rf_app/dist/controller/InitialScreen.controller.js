sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/Device","sap/m/MessageToast","sap/m/MessageBox","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,i,s,n,r){"use strict";return e.extend("com.app.rfapp.controller.InitialScreen",{onInit:function(){this.loadConfiguredSystems()},onsapCancelPress:function(){this.oConfigSap.close()},LoadSapLogon:async function(){this.oConfigSap??=await this.loadFragment({name:"com.app.rfapp.fragments.SapLogon"});this.oConfigSap.open();this.onUserLogin()},handleLinksapPress:async function(){this.oConnetSap??=await this.loadFragment({name:"com.app.rfapp.fragments.ConnecttoSAP"});this.oConnetSap.open();this.getView().byId("idconnectsapeditButton").setVisible(false);this.getView().byId("idconnectsapfinishButton").setVisible(true)},onCloseconnectsap:function(){debugger;this.oConnetSap.close();var e=this.getView().getModel("ModelV2");e.refresh(true)},onsapsubmitPress:function(){var e=this.getView().byId("idsaplogonUserId").getValue();var t=this.getView().byId("idSapLogonPassword").getValue();if(e==="111010"&&t==="ARTIHCUS"){this.getOwnerComponent().getRouter().navTo("Homepage",{id:e})}},onUserLogin:function(){this.getView().byId("idsaplogonUserId").setValue();this.getView().byId("idSapLogonPassword").setValue()},onFinishconnectSAPPress:function(){var e=this.getView();var t=e.byId("idDescriptionInput").getValue();var s=e.byId("idSystemIdInput").getValue();var n=e.byId("idInstanceNumberInput").getValue();var r=e.byId("idClientInput").getValue();var a=e.byId("idApplicationServerInput").getValue();var o=e.byId("idRouterStringInput").getValue();var u=e.byId("idServiceInput").getValue();var d=e.byId("idCheckboxDescription");var l={Description:t,SystemId:s,InstanceNo:n,Client:r,AppServer:a,SapRouterStr:o,SapService:u,DescriptionB:d.getSelected()?s+" / "+r:t};const c=e.getModel(),p=c.bindList("/C_ServiceSet");try{const e=p.create(l);e.created().then(function(e,t){i.show("Created successfully")}).catch(async function(e){i.show("Creation failed");console.error("Error during creation:",e)})}catch(e){console.error("Error while calling create:",e)}},onFinishconnectSAPPresss:function(){var e=this.getView();var t=e.byId("idDescriptionInput").getValue();var s=e.byId("idSystemIdInput").getValue();var n=e.byId("idInstanceNumberInput").getValue();var r=e.byId("idClientInput").getValue();var a=e.byId("idApplicationServerInput").getValue();var o=e.byId("idRouterStringInput").getValue();var u=e.byId("idServiceInput").getValue();var d=e.byId("idCheckboxDescription");var l=true;var c=true;if(!d.getSelected()&&!t){e.byId("idDescriptionInput").setValueState("Error");e.byId("idDescriptionInput").setValueStateText("Description is mandatory when checkbox is not selected.");l=false;c=false}else{e.byId("idDescriptionInput").setValueState("None")}if(!s){e.byId("idSystemIdInput").setValueState("Error");e.byId("idSystemIdInput").setValueStateText("System ID must be a 3-digit value");l=false;c=false}else{e.byId("idSystemIdInput").setValueState("None")}if(!n){e.byId("idInstanceNumberInput").setValueState("Error");e.byId("idInstanceNumberInput").setValueStateText("InstanceNumber must be a 3-digit value");l=false;c=false}else{e.byId("idInstanceNumberInput").setValueState("None")}if(!r){e.byId("idClientInput").setValueState("Error");e.byId("idClientInput").setValueStateText("clientID must be a 3-digit value");l=false;c=false}else{e.byId("idClientInput").setValueState("None")}if(!a){e.byId("idApplicationServerInput").setValueState("Error");l=false;c=false}else{e.byId("idApplicationServerInput").setValueState("None")}if(!u){e.byId("idServiceInput").setValueState("Error");e.byId("idServiceInput").setValueStateText("Service is mandatory");l=false;c=false}else{e.byId("idServiceInput").setValueState("None")}if(!c){sap.m.MessageToast.show("Please fill all mandatory details");return}if(!l){sap.m.MessageToast.show("Please enter correct data");return}var p=this.getView().getModel("ModelV2");p.read("/C_ServiceSet",{filters:[new sap.ui.model.Filter("Description",sap.ui.model.FilterOperator.EQ,t)],filters:[new sap.ui.model.Filter("Client",sap.ui.model.FilterOperator.EQ,r)],filters:[new sap.ui.model.Filter("SapService",sap.ui.model.FilterOperator.EQ,u)],success:function(l){var c=[];if(l.results.length>0){if(l.results.some(e=>e.Client===r)){c.push("The Client must be unique.")}if(l.results.some(e=>e.Description===t)){c.push("The Description must be unique.")}if(l.results.some(e=>e.SapService===u)){c.push("The SAP Service must be unique.")}if(c.length>0){i.show(c.join("\n"));return}}var I=new sap.m.Button({type:"Emphasized",width:"11rem",customData:[new sap.ui.core.CustomData({key:"systemId",value:s})]});if(d.getSelected()){I.setText(s+" / "+r)}else{I.setText(t)}I.attachPress(this.onConfiguredSystemButtonPress.bind(this,I,t,s,r));I.attachBrowserEvent("dblclick",function(){this.LoadSapLogon()}.bind(this));var S={Description:t,SystemId:s,InstanceNo:n,Client:r,AppServer:a,SapRouterStr:o,SapService:u,DescriptionB:d.getSelected()?s+" / "+r:t};p.create("/C_ServiceSet",S,{success:function(){i.show("Configured system saved successfully.");this.clearInputFields(e);var t=e.byId("environmentButtonsHBox");var s=e.byId("_IDCofiguresapLink");t.insertItem(I,t.indexOfItem(s)+1);p.refresh()}.bind(this),error:function(e){i.show("Error saving configured system.")}});this.onCloseconnectsap()}.bind(this),error:function(e){i.show("Error checking existing systems.")}})},clearInputFields:function(e){e.byId("idDescriptionInput").setValue("");e.byId("idSystemIdInput").setValue("");e.byId("idInstanceNumberInput").setValue("");e.byId("idClientInput").setValue("");e.byId("idApplicationServerInput").setValue("");e.byId("idRouterStringInput").setValue("");e.byId("idServiceInput").setValue("");var t=e.byId("idCheckboxDescription");t.setSelected(false)},loadConfiguredSystems:function(){var e=this.getOwnerComponent().getModel("ModelV2");e.read("/C_ServiceSet",{success:function(e){var t=e.results;var i=this.getView().byId("environmentButtonsHBox");t.forEach(function(e){var t=new sap.m.Button({text:e.DescriptionB,type:"Emphasized",width:"11rem"});t.attachPress(this.onConfiguredSystemButtonPress.bind(this,t,e.Description,e.SystemId,e.Client));t.attachBrowserEvent("dblclick",function(){this.LoadSapLogon()}.bind(this));i.addItem(t)},this)}.bind(this),error:function(e){i.show("Error loading configured systems.");console.error(e)}})},onConfiguredSystemButtonPress:function(e,t,i,s){this.selectedButton=e;this.client=s;this.sdedescription=e.mProperties.text},handleAddPress:function(){this.handleLinksapPress()},handleEditPress:function(){this.handleLinksapPress()},onClearconnectSAPPress:function(){var e=this.getView();this.clearInputFields(e)},onDeleteConfiguredSystem:function(){if(!this.selectedButton){i.show("No button selected for deletion.");return}var e=this;s.warning("Are you sure you want to delete the configured system?",{title:"Confirm Deletion",actions:[s.Action.DELETE,s.Action.CANCEL],onClose:function(t){if(t===s.Action.DELETE){var n=e.getView().getModel("ModelV2");var r="/C_ServiceSet('"+this.client+"')";n.remove(r,{success:function(){i.show("Configured system deleted successfully.");var t=e.getView().byId("environmentButtonsHBox");t.removeItem(e.selectedButton);e.selectedButton=null}.bind(e),error:function(e){i.show("Error deleting configured system.");console.error(e)}})}else{i.show("Deletion cancelled.")}}.bind(e)})},onEditConfiguredSystem:function(){if(!this.selectedButton){i.show("No button selected to edit.");return}this.handleLinksapPress();this.getView().byId("idconnectsapeditButton").setVisible(true);this.getView().byId("idconnectsapfinishButton").setVisible(false);var e=this.sdedescription;var t=this.getView().getModel("ModelV2");var s=this;t.read("/C_ServiceSet",{filters:[new sap.ui.model.Filter("DescriptionB",sap.ui.model.FilterOperator.EQ,e)],success:function(t){var i=t.results;function n(t){return t.DescriptionB===e}var r=i.filter(n);if(r){s.byId("idDescriptionInput").setValue(r[0].Description);s.byId("idSystemIdInput").setValue(r[0].SystemId);s.byId("idInstanceNumberInput").setValue(r[0].InstanceNo);s.byId("idClientInput").setValue(r[0].Client);s.byId("idApplicationServerInput").setValue(r[0].AppServer);s.byId("idRouterStringInput").setValue(r[0].SapRouterStr);s.byId("idServiceInput").setValue(r[0].SapService)}}})},onEditconnectSAPPress:function(){var e=this.getView();var t=e.byId("idDescriptionInput").getValue();var i=e.byId("idSystemIdInput").getValue();var s=e.byId("idInstanceNumberInput").getValue();var n=e.byId("idClientInput").getValue();var r=e.byId("idApplicationServerInput").getValue();var a=e.byId("idRouterStringInput").getValue();var o=e.byId("idServiceInput").getValue();var u=e.byId("idCheckboxDescription");var d=this.selectedButton;if(!i){sap.m.MessageToast.show("System ID is required.");return}if(!s){sap.m.MessageToast.show("Instance Number is required.");return}if(!n){sap.m.MessageToast.show("Client is required.");return}if(!r){sap.m.MessageToast.show("Application Server is required.");return}if(!o){sap.m.MessageToast.show("Service is required.");return}if(u.getSelected()){t=i+" / "+n}d.setText(t);var l={Description:t,DescriptionB:t,SystemId:i,InstanceNo:s,Client:n,AppServer:r,SapRouterStr:a,SapService:o};var c=this;var p=this.getView().getModel("ModelV2");p.update("/C_ServiceSet('"+n+"')",l,{success:function(){sap.m.MessageToast.show("Data updated successfully.");c.clearInputFields(e);c.onCloseconnectsap()},error:function(e){sap.m.MessageToast.show("Error updating data.")}})},onBackconnectSAPPress:function(){this.onCloseconnectsap()}})});
//# sourceMappingURL=InitialScreen.controller.js.map